## ターミナルソフトとシェル

GUI 環境の Ubuntu にログインした後，デフォルトでインストールされている「Terminal」という名前のアプリケーションを利用して作業を始めると思います．Mac OS であれば「iTerm」というターミナルソフトがインストールされています．これはターミナルソフトと呼ばれるものです．シェルとは違います．

<figure markdown>
  ![](ss_terminal.png)
  <figcaption>Fig. 1 アプリケーション「Terminal」の見た目</figcaption>
</figure>

このターミナルソフトで様々なコマンド打ち込むことでシェルに対して命令を出すことができます．シェルはこの命令を解釈してカーネルに伝達することで実際の処理が行われます．つまり，シェルは画面上に見えているものを指すわけではなく，その画面を通して動作しているプログラムということになります．

## シェルの分類

シェルはターミナルソフト上で見えているものではなく，プログラムです．ただ1つだけ起動するという訳ではなく，複数起動することもあります．呼び出されれば起動し，処理が終われば終了します．あくまでもプログラムのひとつなので，その他の一般的なプログラムの挙動と同じ概念で考えることができます．

ただ，シェルがどの条件で起動したのかによって色々と呼び分けることがあります．その理由は起動のタイミングによって，ユーザーが指示を出す前に既に読み込まれている変数の種類に違いがあるからです．この変数には例えば「PATH」のようなプログラムを探しに行くディレクトリの情報などがあり，このような変数の総称を環境変数と呼びます．

### ログインシェルと非ログインシェル

コンピュータのあるユーザに対してログインしたその時に起動されるシェルはログインシェルと呼ばれます．例えば SSH 接続を利用してリモートマシンにログインした時です．

### 対話的シェルと非対話的シェル

### カレントシェルとサブシェル

## ターミナル操作で遭難しないための Tips

覚えておいたほうが絶対に幸せになれると思われるキーボード操作を表にしておきます．

### カーソル移動

カーソル位置は ++arrow-left++ と ++arrow-right++ で移動できますが，これを覚えておくと行頭と行末への移動が一瞬です．

| タイプ | 機能 |
| --- | --- |
| ++ctrl+a++ | 行頭まで移動 |
| ++ctrl+e++ | 行末まで移動 |

### コピペ

| タイプ | 機能 |
| --- | --- |
| ++ctrl+k++ | カーソル位置から行末まで切り取り |
| ++ctrl+u++ | 行頭からカーソル位置まで切り取り |
| ++ctrl+y++ | 最後の切り取り文字を貼り付け |

### 履歴

同じコマンドを何度も手打ちする必要はありません．

| タイプ | 機能 |
| --- | --- |
| ++arrow-up++ または ++ctrl+p++ | 行を一つ前のコマンド履歴に置き換え |
| ++arrow-down++ または ++ctrl+n++ | 行を一つ後のコマンド履歴に置き換え |

### その他

| タイプ | 機能 |
| --- | --- |
| ++ctrl+c++ | 実行中のコマンドを強制終了 |
| ++tab++ | 入力補完 |


## 頻出するシェルコマンドの文法

### リダイレクション

!!! note "リダイレクション"
    ``` bash title="書式"
    コマンド > ファイル名
    ```
    `コマンド` の実行結果の出力先を標準出力から `ファイル名` に変更します．ファイル書き込みの権限は `コマンド` に `sudo` を付与していた場合でも元のユーザー権限が適用されます．

### パイプ

!!! note "パイプ"
    ``` bash title="書式"
    コマンド1 | コマンド2 | コマンド3
    ```
    `コマンド1` の標準出力を `コマンド2` の標準入力へ繋げます．ふたつのコマンドだけでなく任意の数のコマンドを順次繋げていくことができます．これらのパイプを構成する各々のコマンドは全てカレントシェルから派生する独立したサブシェルで実行されます．

### 括弧

!!! note "$()"
    - 書式：`$(コマンド)`
    - 意味：`コマンド` の実行結果を文字列として展開する

!!! note "${}"
    - 書式：`${変数}`
    - 意味：`変数` の値を文字列として展開する

### クォーテーション

!!! note "バッククォート"
    - バッククォートで囲まれた文字列をコマンドとして実行した結果を文字列として展開する
    - バッククォートの中でバッククォートは利用できないので注意

!!! note "ダブルクォート"
    ダブルクォートで囲まれた文字列のうち，`$`，バッククォート，バックスラッシュのみを解釈し，それ以外をエスケープした文字列を得る

!!! note "シングルクォート"
    シングルクォートで囲まれた文字列全てをエスケープした文字列を得る

### 条件分岐

!!! note "AND"
    ``` bash title="書式"
    コマンド1 && コマンド2
    ```
    コマンド1が成功した場合のみ，コマンド2を実行する

!!! note "OR"
    ``` bash title="書式"
    コマンド1 || コマンド2
    ```
    コマンド1が失敗した場合のみ，コマンド2を実行する